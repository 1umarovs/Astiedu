{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="main flex-fill">
  <div class="container">
    <nav aria-label="breadcrumb" class="mt-3 mb-3">
      <ol class="breadcrumb p-3 bg-white rounded-3">
        <li class="breadcrumb-items px-2">
          <a class="link-body-emphasis fw-semibold text-decoration-none" href="{% url 'main:home' %}">
            Asosiy
          </a>
        </li>
        <li class="breadcrumb-items px-2">/</li>
        <li class="breadcrumb-items px-2 active">Xalqaro talabalar</li>
      </ol>
    </nav>

    <section class="students mt-3 mb-5" id="students">
      <div class="title mb-3 d-flex justify-content-between align-items-center">
        <h4 class="fz-24 p-2">Foreign students</h4>
      </div>
      <div class="row">

        {% for student in students %}
        <div class="col-md-6 col-lg-4 mb-3">
          <div class="card border-0 student-card "
               role="button"
               data-title="{{ student.name }}"
               data-country="{{ student.country }}"
               data-course="{{ student.course }}"
               data-direction="{{ student.direction }}"
               data-images='[
                 {% if student.images.count > 0 %}
                   {% for img in student.images.all %}
                     "{{ img.img.url }}"{% if not forloop.last %},{% endif %}
                   {% endfor %}
                 {% else %}
                   "{{ student.img.url }}"
                 {% endif %}
               ]'
               data-bs-toggle="modal"
               data-bs-target="#studentModal">
            <div class="card-body p-0">
              <img src="{{ student.img.url }}" class="img-fluid object-fit-cover w-100" style="aspect-ratio: 4/3;" alt="{{ student.name }}">
              <div class="px-4 py-2">
                <h4 class="fz-20">{{ student.name }}</h4>
                <span class="fz-16 text-white bg-primary-subtle rounded p-1">{{ student.country }}</span>
                <p class="mb-2 mt-2"><strong>Course:</strong> {{ student.course }}</p>
                <p class="mb-2"><strong>Direction:</strong> {{ student.direction }}</p>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}

      </div>
    </section>
  </div>
</div>


<!-- Fullscreen Modal -->
<div class="modal fade" id="studentModal" tabindex="-1">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content bg-white text-dark">
      <div class="container">
        <div class="modal-header border-0">
          <button type="button" class="btn-close my-3" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 col-sm-12">
              <!-- Main Swiper -->
              <div class="swiper mainSwiper mb-3">
                <div class="swiper-wrapper"></div>
                <!-- Custom arrows -->
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
              </div>
            </div>
            <div class="col-md-6 col-sm-12 mt-4">
              <h2 id="studentName" class="fw-bold mb-3"></h2>
              <p><strong>Course:</strong> <span id="studentCourse"></span></p>
              <p><strong>Country:</strong> <span id="studentCountry"></span></p>
              <p><strong>Direction:</strong> <span id="studentDirection"></span></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .swiper-button-next,
  .swiper-button-prev {
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.7);
    border-radius: 50%;
    color: #fff;
  }
  .swiper-button-next::after,
  .swiper-button-prev::after {
    font-size: 16px;
    font-weight: bold;
  }
  .swiper-button-next:hover,
  .swiper-button-prev:hover {
    background-color: rgba(0, 0, 0, 0.9);
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", function () {
  let mainSwiper = new Swiper(".mainSwiper", {
    spaceBetween: 10,
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
  });

  document.querySelectorAll(".student-card").forEach((card) => {
    card.addEventListener("click", function () {
      let name = this.dataset.title;
      let country = this.dataset.country;
      let course = this.dataset.course;
      let direction = this.dataset.direction;
      let images = JSON.parse(this.dataset.images);

      document.getElementById("studentName").textContent = name;
      document.getElementById("studentCountry").textContent = country;
      document.getElementById("studentCourse").textContent = course;
      document.getElementById("studentDirection").textContent = direction;

      let mainWrapper = document.querySelector(".mainSwiper .swiper-wrapper");
      mainWrapper.innerHTML = "";

      images.forEach((src) => {
        mainWrapper.innerHTML += `<div class="swiper-slide"><img src="${src}" style="object-fit: cover; width: 100%; aspect-ratio: 4/3;" class="img-fluid rounded"></div>`;
      });

      mainSwiper.update();
    });
  });
});
</script>
{% endblock %}
